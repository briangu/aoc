A::{#(0c0:$x)};B::{A(y)-A(x)};R::B("X";)
W::{:[x~"A";"Y":|x~"B";"Z";"X"]}
L::{:[x~"A";"Z":|x~"B";"X";"Y"]}
Q::{:[y~"Y";:[x~"A";"X":|x~"B";"Y";"Z"]:|y~"X";L(x);W(x)]}
C::{(R(y)*3)+R(Q(x;y))+1}
F::{t::.rl();.p(t);:[(#t)~3;C(t@0;t@2);0]}
.p({.fc(.ic("2.txt"));{+/.mi{F()}\~F()}()}())

