A::{#(0c0:$x)};B::{A(y)-A(x)};L::B("A";);R::B("X";)
J::{l::L(x);r::R(y);:[(r-l)~2;0:|(l-r)~2;6:|l>r;0:|l~r;3;6]+r+1}
F::{t::.rl();:[(#t)~3;J(1#t;2_t);0]}
.p({.fc(.ic("2.txt"));{+/.mi{x;F()}\~F()}()}())
